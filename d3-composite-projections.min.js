// http://geoexamples.com/d3-composite-projections/ v1.4.0 Copyright 2025 Roger Veciana i Rovira
!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("d3-geo"),require("d3-path")):"function"==typeof define&&define.amd?define(["exports","d3-geo","d3-path"],t):t((n="undefined"!=typeof globalThis?globalThis:n||self).d3=n.d3||{},n.d3,n.d3)}(this,(function(n,t,r){"use strict";var e=1e-6;function o(){}var i=1/0,a=i,l=-i,c=l,u={point:function(n,t){n<i&&(i=n);n>l&&(l=n);t<a&&(a=t);t>c&&(c=t)},lineStart:o,lineEnd:o,polygonStart:o,polygonEnd:o,result:function(){var n=[[i,a],[l,c]];return l=c=-(a=i=1/0),n}};function s(n,r,e){var o=r[1][0]-r[0][0],i=r[1][1]-r[0][1],a=n.clipExtent&&n.clipExtent();n.scale(150).translate([0,0]),null!=a&&n.clipExtent(null),t.geoStream(e,n.stream(u));var l=u.result(),c=Math.min(o/(l[1][0]-l[0][0]),i/(l[1][1]-l[0][1])),s=+r[0][0]+(o-c*(l[1][0]+l[0][0]))/2,f=+r[0][1]+(i-c*(l[1][1]+l[0][1]))/2;return null!=a&&n.clipExtent(a),n.scale(150*c).translate([s,f])}function f(n,t,r){return s(n,[[0,0],t],r)}n.geoConicConformalSpain=function(){var n,o,i,a,l,c=t.geoConicConformal().rotate([5,-38.6]).parallels([0,60]),u=t.geoConicConformal().rotate([5,-38.6]).parallels([0,60]),p={point:function(n,t){l=[n,t]}};function v(n){var t=n[0],r=n[1];return l=null,i.point(t,r),l||(a.point(t,r),l)}function d(){return n=o=null,v}return v.invert=function(n){var t=c.scale(),r=c.translate(),e=(n[0]-r[0])/t,o=(n[1]-r[1])/t;return(o>=.05346&&o<.0897&&e>=-.13388&&e<-.0322?u:c).invert(n)},v.stream=function(t){return n&&o===t?n:(r=[c.stream(o=t),u.stream(t)],e=r.length,n={point:function(n,t){for(var o=-1;++o<e;)r[o].point(n,t)},sphere:function(){for(var n=-1;++n<e;)r[n].sphere()},lineStart:function(){for(var n=-1;++n<e;)r[n].lineStart()},lineEnd:function(){for(var n=-1;++n<e;)r[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<e;)r[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<e;)r[n].polygonEnd()}});var r,e},v.precision=function(n){return arguments.length?(c.precision(n),u.precision(n),d()):c.precision()},v.scale=function(n){return arguments.length?(c.scale(n),u.scale(n),v.translate(c.translate())):c.scale()},v.translate=function(n){if(!arguments.length)return c.translate();var t=c.scale(),r=+n[0],o=+n[1];return i=c.translate(n).clipExtent([[r-.06857*t,o-.1288*t],[r+.13249*t,o+.06*t]]).stream(p),a=u.translate([r+.15*t,o-.084*t]).clipExtent([[r-.0831*t+e,o+.053457*t+e],[r+.0146*t-e,o+.7*t-e]]).stream(p),d()},v.fitExtent=function(n,t){return s(v,n,t)},v.fitSize=function(n,t){return f(v,n,t)},v.drawCompositionBorders=function(n){var t=c([-10.244675,34.92]),r=c([-4.04,35.13]),e=c([-4.045,33.12]);n.moveTo(t[0],t[1]),n.lineTo(r[0],r[1]),n.lineTo(e[0],e[1])},v.getCompositionBorders=function(){var n=r.path();return this.drawCompositionBorders(n),n.toString()},v.scale(2700)},n.geoConicConformalSpainModerate=function(){var n,o,i,a,l,c=t.geoConicConformal().rotate([5,-38.6]).parallels([0,60]),u=t.geoConicConformal().rotate([5,-38.6]).parallels([0,60]),p={point:function(n,t){l=[n,t]}};function v(n){var t=n[0],r=n[1];return l=null,i.point(t,r),l||(a.point(t,r),l)}function d(){return n=o=null,v}return v.invert=function(n){var t=c.scale(),r=c.translate(),e=(n[0]-r[0])/t,o=(n[1]-r[1])/t;return(o>=.05346&&o<.0897&&e>=-.13388&&e<-.0322?u:c).invert(n)},v.stream=function(t){return n&&o===t?n:(r=[c.stream(o=t),u.stream(t)],e=r.length,n={point:function(n,t){for(var o=-1;++o<e;)r[o].point(n,t)},sphere:function(){for(var n=-1;++n<e;)r[n].sphere()},lineStart:function(){for(var n=-1;++n<e;)r[n].lineStart()},lineEnd:function(){for(var n=-1;++n<e;)r[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<e;)r[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<e;)r[n].polygonEnd()}});var r,e},v.precision=function(n){return arguments.length?(c.precision(n),u.precision(n),d()):c.precision()},v.scale=function(n){return arguments.length?(c.scale(n),u.scale(n),v.translate(c.translate())):c.scale()},v.translate=function(n){if(!arguments.length)return c.translate();var t=c.scale(),r=+n[0],o=+n[1];return i=c.translate(n).clipExtent([[r-.06857*t,o-.1288*t],[r+.13249*t,o+.06*t]]).stream(p),a=u.translate([r+.13*t,o-.09*t]).clipExtent([[r-.1*t+e,o+.04*t+e],[r-0*t-e,o+.095*t-e]]).stream(p),d()},v.fitExtent=function(n,t){return s(v,n,t)},v.fitSize=function(n,t){return f(v,n,t)},v.drawCompositionBorders=function(n){var t=c([-12.034675,35.065007]),r=c([-5.4208899,35.436988]),e=c([-5.4,33.44359]);n.moveTo(t[0],t[1]),n.lineTo(r[0],r[1]),n.lineTo(e[0],e[1])},v.getCompositionBorders=function(){var n=r.path();return this.drawCompositionBorders(n),n.toString()},v.scale(2700)},n.geoConicConformalSpainOriginal=function(){var n,o,i,a,l,c=t.geoConicConformal().rotate([5,-38.6]).parallels([0,60]),u=t.geoConicConformal().rotate([5,-38.6]).parallels([0,60]),p={point:function(n,t){l=[n,t]}};function v(n){var t=n[0],r=n[1];return l=null,i.point(t,r),l||(a.point(t,r),l)}function d(){return n=o=null,v}return v.invert=function(n){var t=c.scale(),r=c.translate(),e=(n[0]-r[0])/t,o=(n[1]-r[1])/t;return(o>=.05346&&o<.0897&&e>=-.13388&&e<-.0322?u:c).invert(n)},v.stream=function(t){return n&&o===t?n:(r=[c.stream(o=t),u.stream(t)],e=r.length,n={point:function(n,t){for(var o=-1;++o<e;)r[o].point(n,t)},sphere:function(){for(var n=-1;++n<e;)r[n].sphere()},lineStart:function(){for(var n=-1;++n<e;)r[n].lineStart()},lineEnd:function(){for(var n=-1;++n<e;)r[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<e;)r[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<e;)r[n].polygonEnd()}});var r,e},v.precision=function(n){return arguments.length?(c.precision(n),u.precision(n),d()):c.precision()},v.scale=function(n){return arguments.length?(c.scale(n),u.scale(n),v.translate(c.translate())):c.scale()},v.translate=function(n){if(!arguments.length)return c.translate();var t=c.scale(),r=+n[0],o=+n[1];return i=c.translate(n).clipExtent([[r-.06857*t,o-.1288*t],[r+.13249*t,o+.06*t]]).stream(p),a=u.translate([r+.1*t,o-.094*t]).clipExtent([[r-.1331*t+e,o+.053457*t+e],[r-.0354*t-e,o+.08969*t-e]]).stream(p),d()},v.fitExtent=function(n,t){return s(v,n,t)},v.fitSize=function(n,t){return f(v,n,t)},v.drawCompositionBorders=function(n){var t=c([-14.034675,34.965007]),r=c([-7.4208899,35.536988]),e=c([-7.3148275,33.54359]);n.moveTo(t[0],t[1]),n.lineTo(r[0],r[1]),n.lineTo(e[0],e[1])},v.getCompositionBorders=function(){var n=r.path();return this.drawCompositionBorders(n),n.toString()},v.scale(2700)}}));
